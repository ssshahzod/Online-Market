<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MarketPlace</title>
    <!-- (A) LOAD MATERIAL ICONS -->
    <!-- https://google.github.io/material-design-icons/ -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <link rel="stylesheet" type="text/css" href="css/notification.css"/>
    <link rel="stylesheet" type="text/css" href="css/productcards.css">
    <link rel="stylesheet" type="text/css" href="css/menu.css"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="scripts/ProductCard.js"></script>
</head>
<body>
<div  class="hamburger-menu">
    <input id="menu__toggle" type="checkbox" />
    <label class="menu__btn" for="menu__toggle">
        <span></span>
    </label>
    <ul id="menu" class="menu__box">
        <li id="adminPage" ><a class="menu__item" href="/admin">Admin page</a></li>
        <li id="prodPage" ><a class="menu__item" href="/sellers">My profile</a></li>
        <li id="signReq"><a class="menu__item" href="users/sign">Sign Up</a></li>
        <li id="loginReq"><a class="menu__item" href="/login">Login</a></li>
        <li id="item1"><a class="menu__item" href="#">About (Empty page)</a></li>
        <li id="item2"><a class="menu__item" href="#">Contacts (Empty page)</a></li>

        <script> /*hide some menu buttons if user authenticated*/
            var data = "[[${userLogged}]]";
            let login = document.querySelector('#menu li:nth-child(4) a');
            let signup = document.querySelector('#menu li:nth-child(3) a');
            let products = document.querySelector('#menu li:nth-child(2) a');
            if(data !== "false"){
                login.textContent = "Logout"
                login.href = "/logout";
                signup.textContent = "My bucket";
                signup.href = "/bucket";
            }
            let admin = document.getElementById("adminPage");
            let seller = document.getElementById("prodPage");
            admin.style.display = 'none';
            seller.style.display = 'none';
            if(data === "SELLER"){
                seller.style.display = '';
                $.get("/data/id", function(id){
                    let link = "/sellers/" + id + "?state=true";
                    products.href = link;
                });
            } else if(data === "ADMIN"){
                admin.style.display = '';
            }
        </script>
    </ul>
</div>
<script >
    $(document).ready( function(){
        let logout = document.getElementById("logoutNotif");
        logout.style.display = 'none';
        var notif = "[[${param.logout}]]"
        if(notif){
            $('#logoutNotif').fadeIn()
                .delay(1000).fadeOut();
            window.history.replaceState({}, document.title, "/");
        }
    });
</script>
<div class="notification" id="logoutNotif">
    <p>You successfully logged out!</p>
</div>

<h1 class="group-name">Last Updates</h1>
<div class="card-group" id="last_updates_group"></div>
<h1 class="group-name">You would like</h1>
<div class="card-group" id="recom_group"></div>

<script>
    $(function() {
        $.get("/data/products", function(data){
            console.table(data);
            createCards(data, 'last_updates_group');
        });
        $.get("/data/recommendations", function(data){

        });
    });


</script>
</body>
</html>